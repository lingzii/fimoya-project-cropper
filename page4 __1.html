<!DOCTYPE html>
<html>
	<head>
		<script src="js/jquery-3.4.1.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/croppie.css">
		<link rel="stylesheet" type="text/css" href="css/chiachi_css.css">
		<link rel="shortcut icon" href="img/title.gif" />
		<script src="js/fontawesome.js"></script>
		<script src="js/croppie.min.js"></script>
	<title>公主連結</title>
	</head>
	<body>
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
		  <a class="navbar-brand" href="work_index.html">
		    <img src="img/LOGO.jpg" class="button_style">
		  </a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_drop_down" aria-controls="navbar_drop_down" aria-expanded="false" aria-label="Toggle navigation">
		    <span class="navbar-toggler-icon"></span>
		  </button>
		  <div class="collapse navbar-collapse" id="navbar_drop_down">
		    <ul class="navbar-nav mr-auto">
		      <li class="nav-item">
		        <a class="nav-link" href="work_index.html">首頁</a>
		      </li>
		      <li class="nav-item">
		        <a class="nav-link" href="page2.html">抽抽</a>
		      </li>
		      <li class="nav-item">
		        <a class="nav-link" href="page3.html">油油紅包</a>
		      </li>
		      <li class="nav-item active">
		        <a class="nav-link" href="page4.html">協助截圖</a>
		      </li>
		    </ul>
		    <span class="navbar-text">
		      我不是宅宅...真的不是!!
		    </span>
		  </div>
		</nav>
		<div class="container mt-5">
			<div class="row">
				<div class="col-4">
					<div class="input-group mb-3">
					  <div class="input-group-prepend">
					    <span class="input-group-text" id="basic-addon1">形狀</span>
					  </div>
					  <input type="text" class="form-control" placeholder="Username">
					</div>
					<div class="input-group mb-3">
					  <div class="input-group-prepend">
					    <span class="input-group-text" id="basic-addon1">裁切寬度</span>
					  </div>
					  <input type="text" class="form-control" placeholder="預設寬度為300px">
					</div>
					<div class="input-group mb-3">
					  <div class="input-group-prepend">
					    <span class="input-group-text" id="basic-addon1">裁切高度</span>
					  </div>
					  <input type="text" class="form-control" placeholder="預設高度為200px">
					</div>

				</div>
				<div class="col-4">
					<div id="oldImg" style="display:none;"></div>
				</div>
				<div class="col-4">
					<div id="oldImg" style="display:none;"></div>
					<div id="newImgInfo"></div>
					<div id="newImg"></div>
				</div>
			</div>
			<div>
				<label class="btn btn-info"><input id="upload_img" style="display:none;" class="btn btn-info" type="file" accept="image/*"><i class="fa fa-photo"></i> 上傳圖片</label>
				<label class="btn btn-info"><input id="crop_img" style="display:none;"><i class="fa fa-scissors"></i> 裁剪圖片</label>
			</div>
		</div>
	</body>
<script>
(function($) {//插入jQuery的語法(function($) {})(jQuery);
	var width_crop = 300, // 圖片裁切寬度 px 值
	height_crop = 200, // 圖片裁切高度 px 值
	type_crop = "square", // 裁切形狀: square 為方形, circle 為圓形
	width_preview = 350, // 預覽區塊寬度 px 值
	height_preview = 350, // 預覽區塊高度 px 值
	compress_ratio = 0.85, // 圖片壓縮比例 0~1
	type_img = "jpeg", // 圖檔格式 jpeg png webp
	oldImg = new Image(),
	myCrop, file, oldImgDataUrl;

// 裁切初始參數設定
myCrop = $("#oldImg").croppie({
	viewport: { // 裁切區塊
	width: width_crop,
	height: height_crop,
	type: type_crop
	},
	boundary: { // 預覽區塊
	width: width_preview,
	height: height_preview
	}
});

function readFile(input) {
if (input.files && input.files[0]){
file = input.files[0];
} else {
alert("瀏覽器不支援此功能！建議使用最新版本 Chrome");
return;
}

if (file.type.indexOf("image") == 0) {
var reader = new FileReader();

reader.onload = function(e) {
oldImgDataUrl = e.target.result;
oldImg.src = oldImgDataUrl; // 載入 oldImg 取得圖片資訊
myCrop.croppie("bind", {
url: oldImgDataUrl
});
};

reader.readAsDataURL(file);
} else {
alert("您上傳的不是圖檔！");
}
}

function displayCropImg(src) {
var html = "<img src='" + src + "' />";
$("#newImg").html(html);
}

$("#upload_img").on("change", function() {
$("#oldImg").show();
readFile(this);
});

oldImg.onload = function() {
var width = this.width,
height = this.height,
fileSize = Math.round(file.size / 1000),
html = "";

html += "<p>原始圖片尺寸 " + width + "x" + height + "</p>";
html += "<p>檔案大小約 " + fileSize + "k</p>";
$("#oldImg").before(html);
};

function displayNewImgInfo(src) {
var html = "",
filesize = src.length * 0.75;

html += "<p>裁切圖片尺寸 " + width_crop + "x" + height_crop + "</p>";
html += "<p>檔案大小約 " + Math.round(filesize / 1000) + "k</p>";
$("#newImgInfo").html(html);
}

$("#crop_img").on("click", function() {
myCrop.croppie("result", {
type: "canvas",
format: type_img,
quality: compress_ratio
}).then(function(src) {
displayCropImg(src);
displayNewImgInfo(src);
});
});
})(jQuery);
</script>
</html>